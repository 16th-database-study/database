정규화, 반정규화의 개념과 각각을 사용해야 하는 상황에 대해 잘 설명해주었는데, 전체 회의 때 반정규화가 꼭 필요한 실제 사례를(특히 좋아요, 조회수 등을 조회할 때) 공부해보자고 한 게 생각나서 보충 자료 올려요~


## 반정규화를 통한 성능향상 전략


데이터의 무결성이 깨지는 것을 감수하고 반정규화를 하는 이유

 - 데이터 조회 시 입출력량이 많아서 성능이 저하되거나, 
 - 경로가 너무 멀어 조인으로 인해 성능이 저하되거나,
 - 칼럼을 계산하여 읽을 때 성능이 저하될 경우에 반정규화 수행한다.


## 반정규화 적용방법
### 우선 반정규화 대상을 조사하고, 다른 방법을 유도할 수 있는지 검토한다.
| 반정규화 고려 사항 | 다른 방법 검토 |
| --- | --- |
| 자주 사용되는 테이블에 접근 프로세스 수가 많고, 일정 범위만 조회하는 경우 | 클러스터링 적용 : 데이터를 입력/수정/삭제하는 경우 성능이 저하됨. 조회 중심의 테이블이 아니라면 권장하지 않는다. - 인덱스를 조정한다. |
| 대량의 데이터 범위를 자주 처리하는 경우 | 파티셔닝 적용 : 물리적으로 부분적인 테이블로 분리한다. 파티셔닝 키로 조회할 경우 성능이 좋아진다. |
| 많은 조인이 걸려 데이터 조회 시 어려움이 있는 경우 | view를 통해 접근할 수 있도록 한다. |
| 통계성 프로세스에 의해 통계정보를 필요로 하는 경우 | 별도의 통계테이블을 생성한다. |


- 여기서 좋아요, 조회수 등에 해당하는 항목은 마지막 항목으로, 통계성 프로세스에 의해 통계 정보가 필요한 경우에 해당
- 통계 정보 조회를 위해 계속 대량의 조회 쿼리를 보내면 매우 비효율적


  ### 반정규화를 통한 조회 성능 (좋아요, 조회수 등) 개선 예시
  [####우아한 테크코스 프로젝트 팀: 좋아요 수 조회에 걸리는 시간을 반정규화로 개선](https://tecoble.techcourse.co.kr/post/2022-10-10-like-count/)
     - like 테이블에서 join을 통해 수를 일일히 조회하는 방식에서, like_count 컬럼을 추가하여 join 하지 않고도 그 수를 확인할 수 있게 만들었다.
     - 다만, like 테이블에서 삽입, 삭제, 수정이 일어날 때 동시성 문제가 발생하는데 이를 Sync Schedule 으로 해결했다.
 

#### Ref.
[SQLD 데이터모델과 성능 : 성능모델링, 정규화, 반정규화, 파티셔닝, 슈퍼/서브타입 성능, PK/FK 성능, 분산데이터베이스](https://lotuus.tistory.com/49)


[[Mysql, Querydsl] 반정규화를 통한 조회 성능 개선 (트래픽 부하 테스트)](https://tjdtls690.github.io/studycontents/java/2023-11-03-select_perform_improve/)


[좋아요 개수 조회 최적화하기](https://tecoble.techcourse.co.kr/post/2022-10-10-like-count/)
